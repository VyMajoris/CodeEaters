Download exercicios:
http://www.speedyshare.com/petGX/LPBD-NAC2.doc


/*
1-	Desenvolva um script que receba como parâmetro o código do departamento e retorne o nome do departamento, 
o total de funcionários e o salário médio que paga. Utilize o pacote DBMS_OUTPUT.PUT_LINE para exibir o texto resultante. 
Caso o código do departamento não esteja cadastrado na  tabela, retornar a mensagem  “NÃO EXISTE!”. 
*/

create or replace function fun_dados_depto( p_cod_cli in number) 
return sys_refcursor as
l_cursor sys_refcursor;
begin

	open l_cursor for 
  
  select count(d.cd_depto), d.nm_depto, avg(f.vl_salario)  from loc_depto d, loc_funcionario f
where d.cd_depto = f.cd_depto
and d.cd_depto = 50
group by(d.nm_depto);

	return l_cursor;
end;


DECLARE
  cursor_dados SYS_REFCURSOR;
  qtd_func number;
  avg_salario number(10,2);
  nm_depto varchar(10);
BEGIN

  LOOP
      FETCH cursor_dados  INTO qtd_func, nm_depto, avg_salario;
       EXIT WHEN cursor_dados%NOTFOUND;
      DBMS_OUTPUT.PUT_LINE(qtd_func || ' ' || nm_depto || ' ' || avg_salario );
    END LOOP;
END;
